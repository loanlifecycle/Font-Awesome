# circle.yml -- Font-Awesome

machine:
  environment:
    DEPLOY_TOOLKIT: $HOME/deploy_toolkit
    FAILURE_FILE: /tmp/build_failures.txt
general:
  artifacts:
    - index.html
dependencies:
  pre:
    -|
      echo \"<p>Hello, <img width=80 src='img/world.svg'></p>\" > $CIRCLE_ARTIFACTS/hello.html
      mkdir $CIRCLE_ARTIFACTS/img
      curl \"http://wikimedia.org/wikipedia/commons/e/e2/Ambox_globe.svg\" > $CIRCLE_ARTIFACTS/img/world.svg
    # Need deploy_toolkit before anything else
    - git clone git@github.com:loanlifecycle/deploy_toolkit.git $DEPLOY_TOOLKIT
    # pycurl and paho-mqtt are used by build_notifications.py
    - pip install pycurl paho-mqtt mock
    - sudo apt-get install -assume-yes --force-yes ruby-dev
    - sudo gem install bundler
    - sudo npm install -g grunt grunt-cli less less-plugin-clean-css
  override:
    - bundle install
    - npm install
# Just stubbing this since there is no need for anything to run here.
database:
  pre:
    - echo "Database:pre section is empty."
  override:
    - echo "Database:override section is empty."
test:
  pre:
  override:
    - bundle exec jekyll build || ( touch $FAILURE_FILE && exit 1 )
  post:
    - $DEPLOY_TOOLKIT/scripts/build_notifications.py

